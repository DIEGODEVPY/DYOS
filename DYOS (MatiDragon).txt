{$CLEO}
//{$CLEO .csi}
{$NOSOURCE}
/** # Instale o actualize SB siempre con esto:
 * https://github.com/MatiDragon-YT/data
 * o descompile sin el codigo funte.
*/
nop
jump @Main
reg "By MatiDragon"
reg "v 0.1-beta.7"
:Main
const
    ePara_PC      = 0
    ePara_Android = 1
end 

// ####################################################################
           
            // Ajustes de compatibilidad
            $ModoDeCompilacion = ePara_PC
                
            $EmularAndroid     = false
            /** Permite desplazarce por el menu, con
             *  botones que no se usan para eso, como estos:
             *  [7][8][9]
             *  [U][I][O]
             *  [J][K][L]
            */
            
// ####################################################################
const
    Numero_De_Paginas = $Numero_De_Paginas // $10947
    Pagina_Actual     = $Pagina_Actual // $10948
    
    none = 'DUMMY'
    any = -1
end           
var
    Numero_De_Paginas : int  
    Pagina_Actual int
end
if $ModoDeCompilacion == ePara_PC
then 
    while true
        wait 0
        if $ONMISSION == 0
        then
            ResetVars() 
            while $ONMISSION == 0
                wait 0
                if
                    Game.IsTestCheat('MENU')    
                then
                    IniciarMenu()
                end
            end
        end
    end
else  
    ResetVars() 
    IniciarMenu() // para testear rapido
    while true
        wait 0
        if and
            Button.IsPressed(PAD.DISPLAY, 1)
            Button.IsPressed(PAD.DISPLAY, 7)
        then
            IniciarMenu() // para testear rapido
        end
    end
end

:ResetVars
    Numero_De_Paginas = 1
    Pagina_Actual = 1
                                                                           
    $numActores = 0
    $indActor = 0
    $Actor($indActor, 101i) = 0
    $colActor($indActor,101i) = 0 
                       
    $numAutos = 0
    $indAuto = 0
    $Auto($indAuto, 101i) = 0  
    $colAuto($indAuto,101i) = 0
                               
    $numObjeto = 0
    $indObjeto = 0
    $Objeto($indObjeto, 101i) = 0 
    $colObjeto($indObjeto,101i) = 0 
    
    $indStats = 0
    $fStat($indStats,81f) = 0
    $iStat($indStats,256i) = 0
    
    l = 0
    n = 1
return

const
    Menu_Del_Jugador    = 0
    Menu_De_Los_Actores = 1
    Menu_De_Los_Autos   = 2
    Menu_De_Los_Objetos = 3
end
            
:IniciarMenu
    Actor.GetPositionAndOffset($tempvar_X_coord, $tempvar_Y_coord, $tempvar_Z_coord, _Player, 0.0, 0.0, -1.0)
    $tempvar_Angle = Actor.Angle(_Player)
    Interior.GetActive($Active_Interior)   

    Display.SetRadar(false)
    Player.SetCanMove(_Char, false)
    Text.UseCommands(true)
    
    AparecerMenu() 
    Text.PrintHelp('ZZZDYOS')
    
    :MenuPrincipal
    Menu.SetColumn($PANEL, 0, 'ZUIZIND', 'VPLAYER', 'VACTOR', 'VVEHICL', 'VOBJECT', none, none, none, none, none, none, none, none)
    FrenarRetorno()
    FrenarSeleccion()
    repeat
        wait 0
        if EntrarAlMenu()
        then
            if $Seleccion == menu_del_jugador
            then {$I ./src/player/menu.txt}
            end   
            if $Seleccion == menu_de_los_actores
            then {$I ./src/actor/menu.txt} 
            end   
            if $Seleccion == menu_de_los_autos
            then {$I ./src/vehicle/menu.txt} 
            end 
            if $Seleccion == menu_de_los_objetos
            then {$I ./src/object/menu.txt}   
            end
            FrenarSeleccion()
        end
    until SalirDelMenu()
    
    :CerrarElMenu
    EsconderMenu()
    Display.SetRadar(true)
    Player.SetCanMove(_Char, true)  
    Text.UseCommands(false)     
    
    Text.ClearHelp()
return 

:AparecerMenu
    $PANEL = Menu.Create(none, 29.0, 154.0, 180.0, 1, true, true, Align.Left) 
return    
:EsconderMenu
    Menu.Remove($PANEL)
return
        

// CREADORES
{$I ./src/actor/create.txt}
{$I ./src/vehicle/create.txt}
{$I ./src/object/create.txt}

// CONTROL DE LOS MENUS
{$I ./src/ControlesDelMenu.txt}
{$I ./src/ControlDeDesplazamiento3D.txt}

:ImpresionDeLaPaginacion
    if $ModoDeCompilacion == ePara_PC
    then Text.DisplayWith2Numbers(178.0,179.0,'ZCLC',Pagina_Actual,Numero_De_Paginas) 
    else Text.DisplayWith2Numbers(130.0,179.0,'ZCLC',Pagina_Actual,Numero_De_Paginas) 
    end   
return

:FrenarSeleccion
    while EntrarAlMenu()
        wait 0
        ImpresionDeLaPaginacion()
    end
return

:FrenarPaginacion 
    while MovimientoVerticalDelMenu()
        wait 0
        ImpresionDeLaPaginacion()
    end
return

:FrenarRetorno
    while SalirDelMenu()
        wait 0
        ImpresionDeLaPaginacion()
    end
return

:DarArmaConMunicion {
        0@ - Actor
        1@ - Model
        2@ - Weapon
        3@ - Ammo
    }
    Model.Load(param2)
    repeat
        wait 0
    until Model.Available(param2)
    Actor.setGiveWeaponAndAmmo(param1, param3, param4)
    Model.Release(param2) 
    MensajeDeAplicado() 
    FrenarSeleccion()
ret 0

:Polyfil_DarArmaConMunicionAlJugador {actor _Player model #NULL weapon_id 0 ammo 1 }
    Model.Load(param2)
    repeat
        wait 0
    until Model.Available(param2)
    Actor.SetGiveWeaponAndAmmo(_Player, param3, param4)
    Model.Release(param2) 
    MensajeDeAplicado() 
    FrenarSeleccion()    
return

:Polyfil_DarArmaConMunicionAlActor {actor $Actor($indActor,101i) model #NULL weapon_id 0 ammo 1 }
    Model.Load(param2)
    repeat
        wait 0
    until Model.Available(param2)
    Actor.SetGiveWeaponAndAmmo($Actor($indActor,101i), param3, param4)
    Model.Release(param2) 
    MensajeDeAplicado() 
    FrenarSeleccion()    
return

:MensajeDeAplicado
    Text.PrintHelp('ZUIZAPL')
return



// CEMENTERIO DE FUNCIONES



if $Seleccion == 4
then
    add_text_label '.' "CJ no quiere ser modificado, asi que lo reemplazara un familiar."
    Text.PrintHelp('.')
    Menu.SetColumn($PANEL, 0, 'vWalk', 'zWALK00','zWALK01','zWALK02','zWALK03','zWALK04','zWALK05','zWALK06','zWALK07','zWALK08','zWALK09','zWALK10','zWALK11')
    FrenarSeleccion()
    repeat
        wait 0
        if Button.IsPressed(Pad.PLAYER1, VB.SPRINT) {(Space)}
        then 
            $Seleccion = Menu.GetItemSelected($PANEL)
            
            if Actor.IsModel(_Player, 0)
            then
                Model.Load(#FAM2)
                Model.Requested()
                Player.SetModel(_Char, #FAM2)
            end
            
            if $Seleccion == 0
            then Actor.SetWalkStyle(_Player, 'MAN')
            end
            if $Seleccion == 1
            then Actor.SetWalkStyle(_Player, 'WOMAN') 
            end
            if $Seleccion == 2
            then Actor.SetWalkStyle(_Player, 'OLDMAN')
            end
            if $Seleccion == 3
            then Actor.SetWalkStyle(_Player, 'oldwoman')
            end 
            if $Seleccion == 4
            then Actor.SetWalkStyle(_Player, 'oldfatman')
            end 
            if $Seleccion == 5
            then Actor.SetWalkStyle(_Player, 'oldfatwoman')
            end 
            if $Seleccion == 6
            then Actor.SetWalkStyle(_Player, 'fatman')
            end  
            if $Seleccion == 7
            then Actor.SetWalkStyle(_Player, 'fatwoman')
            end
            if $Seleccion == 8
            then Actor.SetWalkStyle(_Player, 'jogger')
            end
            if $Seleccion == 9
            then Actor.SetWalkStyle(_Player, 'jogwoman')
            end
            if $Seleccion == 10
            then Actor.SetWalkStyle(_Player, 'gang1')
            end 
            if $Seleccion == 11
            then Actor.SetWalkStyle(_Player, 'gang2')
            end
            FrenarSeleccion()
        end
    until Button.IsPressed(PAD.PLAYER1, VB.ENTER_VEHICLE) 
    jump @MenuDelJugador
end